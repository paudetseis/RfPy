

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Classes &mdash; Home 0.2.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=37f418d5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Scripts" href="scripts.html" />
    <link rel="prev" title="Licence" href="rfpy.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Home
              <img src="_static/RfPy_logo_small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Quick Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="links.html">GitHub Repositories</a></li>
<li class="toctree-l1"><a class="reference internal" href="links.html#references">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="rfpy.html">Licence</a></li>
<li class="toctree-l1"><a class="reference internal" href="rfpy.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="rfpy.html#basic-usage">Basic Usage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Classes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rfdata">RFData</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rfpy.rfdata.RFData"><code class="docutils literal notranslate"><span class="pre">RFData</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.rfdata.RFData.add_event"><code class="docutils literal notranslate"><span class="pre">RFData.add_event()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.rfdata.RFData.add_data"><code class="docutils literal notranslate"><span class="pre">RFData.add_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.rfdata.RFData.download_data"><code class="docutils literal notranslate"><span class="pre">RFData.download_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.rfdata.RFData.rotate"><code class="docutils literal notranslate"><span class="pre">RFData.rotate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.rfdata.RFData.calc_snr"><code class="docutils literal notranslate"><span class="pre">RFData.calc_snr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.rfdata.RFData.deconvolve"><code class="docutils literal notranslate"><span class="pre">RFData.deconvolve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.rfdata.RFData.to_stream"><code class="docutils literal notranslate"><span class="pre">RFData.to_stream()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.rfdata.RFData.save"><code class="docutils literal notranslate"><span class="pre">RFData.save()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#class-meta">Class Meta</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.rfdata.Meta"><code class="docutils literal notranslate"><span class="pre">Meta</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hkstack">HkStack</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rfpy.hk.HkStack"><code class="docutils literal notranslate"><span class="pre">HkStack</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.hk.HkStack.stack"><code class="docutils literal notranslate"><span class="pre">HkStack.stack()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.hk.HkStack.stack_dip"><code class="docutils literal notranslate"><span class="pre">HkStack.stack_dip()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.hk.HkStack.average"><code class="docutils literal notranslate"><span class="pre">HkStack.average()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.hk.HkStack.error"><code class="docutils literal notranslate"><span class="pre">HkStack.error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.hk.HkStack.plot"><code class="docutils literal notranslate"><span class="pre">HkStack.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.hk.HkStack.save"><code class="docutils literal notranslate"><span class="pre">HkStack.save()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#harmonics">Harmonics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rfpy.harmonics.Harmonics"><code class="docutils literal notranslate"><span class="pre">Harmonics</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.harmonics.Harmonics.dcomp_find_azim"><code class="docutils literal notranslate"><span class="pre">Harmonics.dcomp_find_azim()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.harmonics.Harmonics.dcomp_fix_azim"><code class="docutils literal notranslate"><span class="pre">Harmonics.dcomp_fix_azim()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.harmonics.Harmonics.forward"><code class="docutils literal notranslate"><span class="pre">Harmonics.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.harmonics.Harmonics.plot"><code class="docutils literal notranslate"><span class="pre">Harmonics.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.harmonics.Harmonics.save"><code class="docutils literal notranslate"><span class="pre">Harmonics.save()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ccpimage">CCPimage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rfpy.ccp.CCPimage"><code class="docutils literal notranslate"><span class="pre">CCPimage</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.ccp.CCPimage.add_rfstream"><code class="docutils literal notranslate"><span class="pre">CCPimage.add_rfstream()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.ccp.CCPimage.prep_data"><code class="docutils literal notranslate"><span class="pre">CCPimage.prep_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.ccp.CCPimage.prestack"><code class="docutils literal notranslate"><span class="pre">CCPimage.prestack()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.ccp.CCPimage.ccp"><code class="docutils literal notranslate"><span class="pre">CCPimage.ccp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.ccp.CCPimage.gccp"><code class="docutils literal notranslate"><span class="pre">CCPimage.gccp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.ccp.CCPimage.linear_stack"><code class="docutils literal notranslate"><span class="pre">CCPimage.linear_stack()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.ccp.CCPimage.phase_weighted_stack"><code class="docutils literal notranslate"><span class="pre">CCPimage.phase_weighted_stack()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.ccp.CCPimage.save"><code class="docutils literal notranslate"><span class="pre">CCPimage.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.ccp.CCPimage.plot_ccp"><code class="docutils literal notranslate"><span class="pre">CCPimage.plot_ccp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rfpy.ccp.CCPimage.plot_gccp"><code class="docutils literal notranslate"><span class="pre">CCPimage.plot_gccp()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#modules">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-rfpy.binning">binning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rfpy.binning.bin"><code class="docutils literal notranslate"><span class="pre">bin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rfpy.binning.bin_baz_slow"><code class="docutils literal notranslate"><span class="pre">bin_baz_slow()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rfpy.binning.bin_all"><code class="docutils literal notranslate"><span class="pre">bin_all()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-rfpy.plotting">plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rfpy.plotting.wiggle"><code class="docutils literal notranslate"><span class="pre">wiggle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rfpy.plotting.wiggle_bins"><code class="docutils literal notranslate"><span class="pre">wiggle_bins()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Scripts &amp; Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Home</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Classes</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <figure class="align-center">
<img alt="_images/RfPy_logo.png" src="_images/RfPy_logo.png" />
</figure>
<section id="classes">
<h1>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h1>
<p><code class="xref py py-mod docutils literal notranslate"><span class="pre">rfpy</span></code> defines the following base classes:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#rfpy.rfdata.RFData" title="rfpy.rfdata.RFData"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFData</span></code></a></p></li>
<li><p><a class="reference internal" href="#rfpy.hk.HkStack" title="rfpy.hk.HkStack"><code class="xref py py-class docutils literal notranslate"><span class="pre">HkStack</span></code></a></p></li>
<li><p><a class="reference internal" href="#rfpy.harmonics.Harmonics" title="rfpy.harmonics.Harmonics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Harmonics</span></code></a></p></li>
<li><p><a class="reference internal" href="#rfpy.ccp.CCPimage" title="rfpy.ccp.CCPimage"><code class="xref py py-class docutils literal notranslate"><span class="pre">CCPimage</span></code></a></p></li>
</ul>
<section id="rfdata">
<h2>RFData<a class="headerlink" href="#rfdata" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="rfpy.rfdata.RFData">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rfpy.rfdata.</span></span><span class="sig-name descname"><span class="pre">RFData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zcomp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Z'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.rfdata.RFData" title="Link to this definition"></a></dt>
<dd><p>A RFData object contains Class attributes that associate
station information with a single event (i.e., earthquake)
metadata, corresponding raw and rotated seismograms and
receiver functions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The object is initialized with the <code class="docutils literal notranslate"><span class="pre">sta</span></code> field only, and
other attributes are added to the object as the analysis proceeds.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sta</strong> (<em>object</em>) – Object containing station information - from <code class="xref py py-mod docutils literal notranslate"><span class="pre">stdb</span></code> database.</p></li>
<li><p><strong>meta</strong> (<a class="reference internal" href="#rfpy.rfdata.Meta" title="rfpy.rfdata.Meta"><code class="xref py py-class docutils literal notranslate"><span class="pre">Meta</span></code></a>) – Object of metadata information for single event (initially set to None)</p></li>
<li><p><strong>data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream object containing the three-component seismograms (either
un-rotated or rotated by the method <code class="xref py py-func docutils literal notranslate"><span class="pre">rotate()</span></code>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rfpy.rfdata.RFData.add_event">
<span class="sig-name descname"><span class="pre">add_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gacmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gacmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'P'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.rfdata.RFData.add_event" title="Link to this definition"></a></dt>
<dd><p>Adds event metadata to RFData object, including travel time info
of P wave.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">event</span></code>) – Event XML object</p></li>
<li><p><strong>returned</strong> (<em>bool</em>) – Whether or not to return the <code class="docutils literal notranslate"><span class="pre">accept</span></code> attribute</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>accept</strong> – Whether or not the object is accepted for further analysis</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.rfdata.RFData.add_data">
<span class="sig-name descname"><span class="pre">add_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_sr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.rfdata.RFData.add_data" title="Link to this definition"></a></dt>
<dd><p>Adds stream as object attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream container for NEZ seismograms</p></li>
<li><p><strong>returned</strong> (<em>bool</em>) – Whether or not to return the <code class="docutils literal notranslate"><span class="pre">accept</span></code> attribute</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rfpy.rfdata.RFData.zne_data">
<span class="sig-name descname"><span class="pre">zne_data</span></span><a class="headerlink" href="#rfpy.rfdata.RFData.zne_data" title="Link to this definition"></a></dt>
<dd><p>Stream container for NEZ seismograms</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>accept</strong> – Whether or not the object is accepted for further analysis</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.rfdata.RFData.download_data">
<span class="sig-name descname"><span class="pre">download_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">client</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_sr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_response</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.rfdata.RFData.download_data" title="Link to this definition"></a></dt>
<dd><p>Downloads seismograms based on event origin time and
P phase arrival and resamples the waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>client</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code>) – Client object</p></li>
<li><p><strong>new_sr</strong> (<em>float</em>) – New sampling rate (Hz)</p></li>
<li><p><strong>dts</strong> (<em>float</em>) – Time duration (sec)</p></li>
<li><p><strong>remove_response</strong> (<em>bool</em>) – Remove instrument response from seismogram and resitute to true ground
velocity (m/s) using obspy.core.trace.Trace.remove_response()</p></li>
<li><p><strong>returned</strong> (<em>bool</em>) – Whether or not to return the <code class="docutils literal notranslate"><span class="pre">accept</span></code> attribute</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Output diagnostics to screen</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>accept</strong> – Whether or not the object is accepted for further analysis</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rfpy.rfdata.RFData.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#rfpy.rfdata.RFData.data" title="Link to this definition"></a></dt>
<dd><p>Stream containing <code class="xref py py-class docutils literal notranslate"><span class="pre">Trace</span></code> objects</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.rfdata.RFData.rotate">
<span class="sig-name descname"><span class="pre">rotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.rfdata.RFData.rotate" title="Link to this definition"></a></dt>
<dd><p>Rotates 3-component seismograms from vertical (Z),
east (E) and north (N) to longitudinal (L),
radial (Q) and tangential (T) components of motion.
Note that the method ‘rotate’ from <code class="docutils literal notranslate"><span class="pre">obspy.core.stream.Stream</span></code>
is used for the rotation <code class="docutils literal notranslate"><span class="pre">'ZNE-&gt;ZRT'</span></code> and <code class="docutils literal notranslate"><span class="pre">'ZNE-&gt;LQT'</span></code>.
Rotation <code class="docutils literal notranslate"><span class="pre">'ZNE-&gt;PVH'</span></code> is implemented separately here
due to different conventions.</p>
<p>Can also rotate Z12 to ZNE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp</strong> (<em>float</em>) – P-wave velocity at surface (km/s)</p></li>
<li><p><strong>vs</strong> (<em>float</em>) – S-wave velocity at surface (km/s)</p></li>
<li><p><strong>align</strong> (<em>str</em>) – Alignment of coordinate system for rotation
(‘ZNE’, ‘ZRT’, ‘LQT’, or ‘PVH’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>rotated</strong> – Whether or not the object has been rotated</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.rfdata.RFData.calc_snr">
<span class="sig-name descname"><span class="pre">calc_snr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.rfdata.RFData.calc_snr" title="Link to this definition"></a></dt>
<dd><p>Calculates signal-to-noise ratio on either Z, L or P component</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> (<em>float</em>) – Duration (sec)</p></li>
<li><p><strong>fmin</strong> (<em>float</em>) – Minimum frequency corner for SNR filter (Hz)</p></li>
<li><p><strong>fmax</strong> (<em>float</em>) – Maximum frequency corner for SNR filter (Hz)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rfpy.rfdata.RFData.snr">
<span class="sig-name descname"><span class="pre">snr</span></span><a class="headerlink" href="#rfpy.rfdata.RFData.snr" title="Link to this definition"></a></dt>
<dd><p>Signal-to-noise ratio on vertical component (dB)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rfpy.rfdata.RFData.snrh">
<span class="sig-name descname"><span class="pre">snrh</span></span><a class="headerlink" href="#rfpy.rfdata.RFData.snrh" title="Link to this definition"></a></dt>
<dd><p>Signal-to-noise ratio on radial component (dB)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.rfdata.RFData.deconvolve">
<span class="sig-name descname"><span class="pre">deconvolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'P'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wiener'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'complete'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_filt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gfilt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wlevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writeto</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.rfdata.RFData.deconvolve" title="Link to this definition"></a></dt>
<dd><p>Deconvolves three-component data using one component as the source wavelet.
The source component is always taken as the dominant compressional
component, which can be either ‘Z’, ‘L’, or ‘P’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp</strong> (<em>float</em>) – P-wave velocity at surface (km/s)</p></li>
<li><p><strong>vs</strong> (<em>float</em>) – S-wave velocity at surface (km/s)</p></li>
<li><p><strong>align</strong> (<em>str</em>) – Alignment of coordinate system for rotation
(‘ZRT’, ‘LQT’, or ‘PVH’)</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Method for deconvolution. Options are ‘wiener’, ‘water’ or
‘multitaper’</p></li>
<li><p><strong>wavelet</strong> (<em>str</em>) – Type of wavelet for deconvolution. Options are ‘complete’, ‘time’ or
‘envelope’</p></li>
<li><p><strong>envelope_threshold</strong> (<em>float</em>) – Threshold [0-1] used in <code class="docutils literal notranslate"><span class="pre">wavelet='envelope'</span></code>.</p></li>
<li><p><strong>time</strong> (<em>float</em>) – Window length used in <code class="docutils literal notranslate"><span class="pre">wavelet='time'</span></code>.
Minimum window length for <code class="docutils literal notranslate"><span class="pre">wavelet='envelope'</span></code>.</p></li>
<li><p><strong>pre_filt</strong> (<em>list</em><em> of </em><em>2 floats</em>) – Low and High frequency corners of bandpass filter applied
before deconvolution</p></li>
<li><p><strong>gfilt</strong> (<em>float</em>) – Center frequency of Gaussian filter (Hz).</p></li>
<li><p><strong>wlevel</strong> (<em>float</em>) – Water level used in <code class="docutils literal notranslate"><span class="pre">method='water'</span></code>.</p></li>
<li><p><strong>writeto</strong> (<em>str</em><em> or </em><em>None</em>) – Write wavelets for deconvolution to file.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rfpy.rfdata.RFData.rf">
<span class="sig-name descname"><span class="pre">rf</span></span><a class="headerlink" href="#rfpy.rfdata.RFData.rf" title="Link to this definition"></a></dt>
<dd><p>Stream containing the receiver function traces</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.rfdata.RFData.to_stream">
<span class="sig-name descname"><span class="pre">to_stream</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.rfdata.RFData.to_stream" title="Link to this definition"></a></dt>
<dd><p>Method to switch from RFData object to Stream object.
This allows easier manipulation of the receiver functions
for post-processing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.rfdata.RFData.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.rfdata.RFData.save" title="Link to this definition"></a></dt>
<dd><p>Saves RFData object to file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – File name for RFData object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="class-meta">
<h3>Class Meta<a class="headerlink" href="#class-meta" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="rfpy.rfdata.Meta">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rfpy.rfdata.</span></span><span class="sig-name descname"><span class="pre">Meta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gacmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gacmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'P'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.rfdata.Meta" title="Link to this definition"></a></dt>
<dd><p>A Meta object contains attributes associated with the metadata
for a single receiver function analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code>) – Origin time of earthquake</p></li>
<li><p><strong>dep</strong> (<em>float</em>) – Depth of hypocenter (km)</p></li>
<li><p><strong>lon</strong> (<em>float</em>) – Longitude coordinate of epicenter</p></li>
<li><p><strong>lat</strong> (<em>float</em>) – Latitude coordinate of epicenter</p></li>
<li><p><strong>mag</strong> (<em>float</em>) – Magnitude of earthquake</p></li>
<li><p><strong>gac</strong> (<em>float</em>) – Great arc circle between station and epicenter (degrees)</p></li>
<li><p><strong>epi_dist</strong> (<em>float</em>) – Epicentral distance between station and epicenter (km)</p></li>
<li><p><strong>baz</strong> (<em>float</em>) – Back-azimuth - pointing to earthquake from station (degrees)</p></li>
<li><p><strong>az</strong> (<em>float</em>) – Azimuth - pointing to station from earthquake (degrees)</p></li>
<li><p><strong>ttime</strong> (<em>float</em>) – Predicted arrival time (sec)</p></li>
<li><p><strong>ph</strong> (<em>str</em>) – Phase name</p></li>
<li><p><strong>slow</strong> (<em>float</em>) – Horizontal slowness of phase</p></li>
<li><p><strong>inc</strong> (<em>float</em>) – Incidence angle of phase at surface</p></li>
<li><p><strong>vp</strong> (<em>float</em>) – P-wave velocity at surface (km/s)</p></li>
<li><p><strong>vs</strong> (<em>float</em>) – S-wave velocity at surface (km/s)</p></li>
<li><p><strong>align</strong> (<em>str</em>) – Alignment of coordinate system for rotation
(‘ZRT’, ‘LQT’, or ‘PVH’)</p></li>
<li><p><strong>rotated</strong> (<em>bool</em>) – Whether or not data have been rotated to <code class="docutils literal notranslate"><span class="pre">align</span></code>
coordinate system</p></li>
<li><p><strong>zcomp</strong> (<em>str</em>) – Vertical Component Identifier. Should be a single character.
This is different then ‘Z’ only for fully unknown component
orientation (i.e., components are 1, 2, 3)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="hkstack">
<h2>HkStack<a class="headerlink" href="#hkstack" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="rfpy.hk.HkStack">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rfpy.hk.</span></span><span class="sig-name descname"><span class="pre">HkStack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rfV1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfV2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strike</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.hk.HkStack" title="Link to this definition"></a></dt>
<dd><p>A HkStack object contains attributes and methods to stack radial
receiver functions along moveout curves for point measurements
of the depth to Moho (H) and P-to-S velocity ratio (k) beneath
a seismic stations. The object is initialized with at least one
<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code> containing observed (or synthetised)
radial receiver functions. The methods available can produce linear
weighted stacks or product stacks, and can be used in the presence
of flat or dipping Moho (with known strike and dip).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The object is initialized with the <code class="docutils literal notranslate"><span class="pre">rfV1</span></code> field only, and
other attributes are added to the object as the analysis proceeds.
A second <code class="docutils literal notranslate"><span class="pre">rfV2</span></code> can be included, which is typically a copy of <code class="docutils literal notranslate"><span class="pre">rfV1</span></code>
filtered at different corner frequencies and is used to stack along the
Pps and Pss moveout curves.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rfV1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream object containing the radial-component receiver function
seismograms</p></li>
<li><p><strong>rfV2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream object containing the radial-component receiver function
seismograms (typically filtered at lower frequencies)</p></li>
<li><p><strong>strike</strong> (<em>float</em>) – Strike angle of dipping Moho (has to be known or estimated a priori)</p></li>
<li><p><strong>dip</strong> (<em>float</em>) – Dip angle of Moho (has to be known or estimated a priori)</p></li>
<li><p><strong>vp</strong> (<em>float</em>) – Mean P-wave velocity of the crust (km/s)</p></li>
<li><p><strong>kbound</strong> (<em>list</em>) – List of 2 floats that determine the range of Vp/Vs values to search</p></li>
<li><p><strong>dk</strong> (<em>float</em>) – Spacing between adjacent Vp/Vs search values</p></li>
<li><p><strong>hbound</strong> (<em>list</em>) – List of 2 floats that determine the range of Moho depth values to search</p></li>
<li><p><strong>dh</strong> (<em>float</em>) – Spacing between adjacent Moho depth search values</p></li>
<li><p><strong>weights</strong> (<em>list</em>) – List of 3 floats that determine the relative weights of the individual
phase stacks to be used in the final stack. The third weight is negative
since Pss amplitudes are opposite to those of the Ps and Pps phases.</p></li>
<li><p><strong>phases</strong> (<em>list</em>) – List of 3 strings (‘ps’, ‘pps’, ‘pss’) corresponding to the thre phases
of interest (<cite>do not modify this attribute</cite>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rfpy.hk.HkStack.stack">
<span class="sig-name descname"><span class="pre">stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.hk.HkStack.stack" title="Link to this definition"></a></dt>
<dd><p>Method to calculate Hk stacks from radial receiver functions.
The stacks are calculated using phase-weighted stacking for
individual phases and take the median of the weighted stack
to avoid bias by outliers.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If two streams are available as attributes, the method will assume
that the second stream should be used for stacking along the Pps
and Pss move out curves (e.g., if the second stream contains
lower frequency signals). Furthermore, If the <code class="docutils literal notranslate"><span class="pre">vp</span></code> argument is
not specified, the method will use the
value set during initialization (<code class="docutils literal notranslate"><span class="pre">vp=6.0</span></code> km/s)</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vp</strong> (<em>float</em>) – Mean crust P-wave velocity (km/s).</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rfpy.hk.HkStack.pws">
<span class="sig-name descname"><span class="pre">pws</span></span><a class="headerlink" href="#rfpy.hk.HkStack.pws" title="Link to this definition"></a></dt>
<dd><p>Array of phase stacks, where the outer dimension corresponds
to the phase index (shape <code class="docutils literal notranslate"><span class="pre">nH,</span> <span class="pre">nk,</span> <span class="pre">nph</span></code>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rfpy.hk.HkStack.sig">
<span class="sig-name descname"><span class="pre">sig</span></span><a class="headerlink" href="#rfpy.hk.HkStack.sig" title="Link to this definition"></a></dt>
<dd><p>Variance of phase stacks, where the outer dimension corresponds
to the phase index (shape <code class="docutils literal notranslate"><span class="pre">nH,</span> <span class="pre">nk,</span> <span class="pre">nph</span></code>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.hk.HkStack.stack_dip">
<span class="sig-name descname"><span class="pre">stack_dip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strike</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.hk.HkStack.stack_dip" title="Link to this definition"></a></dt>
<dd><p>Method to calculate Hk stacks from radial receiver functions
using known stike and dip angles of the Moho.
The stacks are calculated using phase-weighted stacking for
individual phases and take the median of the weighted stack
to avoid bias by outliers.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If two streams are available as attributes, the method will assume
that the second stream should be used for stacking along the Pps
and Pss move out curves (e.g., if the second stream contains
lower frequency signals). Furthermore,
If the arguments are not specified, the method will use the
values set during initialization (<code class="docutils literal notranslate"><span class="pre">vp=6.0</span></code> km/s,
<code class="docutils literal notranslate"><span class="pre">strike=0.</span></code>, <code class="docutils literal notranslate"><span class="pre">dip=0.</span></code>)</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp</strong> (<em>float</em>) – Mean crust P-wave velocity (km/s).</p></li>
<li><p><strong>strike</strong> (<em>float</em>) – Strike angle of dipping Moho (has to be known or estimated a priori)</p></li>
<li><p><strong>dip</strong> (<em>float</em>) – Dip angle of Moho (has to be known or estimated a priori)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">pws</span></span><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Array of phase stacks, where the outer dimension corresponds
to the phase index (shape <code class="docutils literal notranslate"><span class="pre">nH,</span> <span class="pre">nk,</span> <span class="pre">nph</span></code>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">sig</span></span><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Variance of phase stacks, where the outer dimension corresponds
to the phase index (shape <code class="docutils literal notranslate"><span class="pre">nH,</span> <span class="pre">nk,</span> <span class="pre">nph</span></code>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.hk.HkStack.average">
<span class="sig-name descname"><span class="pre">average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">typ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'amp'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.hk.HkStack.average" title="Link to this definition"></a></dt>
<dd><p>Method to combine the phase-weighted stacks to produce a final
stack, from which to estimate the H and k parameters and their
associated errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>typ</strong> (<em>str</em>) – How the phase-weigthed stacks should be combined to produce
a final stack. Available options are: weighted sum (<code class="docutils literal notranslate"><span class="pre">typ=sum</span></code>)
or product (<code class="docutils literal notranslate"><span class="pre">typ=product</span></code>).</p></li>
<li><p><strong>q</strong> (<em>float</em>) – Confidence level for the error estimate</p></li>
<li><p><strong>err_method</strong> (<em>str</em>) – How errors should be estimated. Options are <code class="docutils literal notranslate"><span class="pre">err_method='amp'</span></code>
to estimate errors from amplitude, or <code class="docutils literal notranslate"><span class="pre">err_method='stats'</span></code> to
use a statistical F test from the residuals.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.hk.HkStack.error">
<span class="sig-name descname"><span class="pre">error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'amp'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.hk.HkStack.error" title="Link to this definition"></a></dt>
<dd><p>Method to determine the error on H and k estimates.</p>
<p>From Walsh, JGR, 2013</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<em>float</em>) – Confidence level for the error estimate</p></li>
<li><p><strong>err_method</strong> (<em>str</em>) – How errors should be estimated. Options are <code class="docutils literal notranslate"><span class="pre">err_method='amp'</span></code>
to estimate errors from amplitude, or <code class="docutils literal notranslate"><span class="pre">err_method='stats'</span></code> to
use a statistical F test from the residuals.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.hk.HkStack.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">form</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.hk.HkStack.plot" title="Link to this definition"></a></dt>
<dd><p>Method to plot H-K stacks. By default all 4 panels
are plotted: The <code class="docutils literal notranslate"><span class="pre">ps</span></code>, <code class="docutils literal notranslate"><span class="pre">pps</span></code> and <code class="docutils literal notranslate"><span class="pre">pss</span></code> stacks, and the
final (averaged) stack. Error contours are also plotted,
as well as the position of the maximum stack values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save</strong> (<em>bool</em>) – Whether or not to save the Figure</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title of plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.hk.HkStack.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.hk.HkStack.save" title="Link to this definition"></a></dt>
<dd><p>Saves HkStack object to file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – File name for HkStack object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="harmonics">
<h2>Harmonics<a class="headerlink" href="#harmonics" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="rfpy.harmonics.Harmonics">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rfpy.harmonics.</span></span><span class="sig-name descname"><span class="pre">Harmonics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radialRF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transvRF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.harmonics.Harmonics" title="Link to this definition"></a></dt>
<dd><p>A Harmonics object contains attributes and methods to decompose
radial and transverse component receiver functions into
back-azimuth harmonics. The object is initialized with two
<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code> objects containing observed (or synthetised)
radial and transverse receiver functions. The methods available
can decompose the receiver functions along a fixed azimuth, or
search for the optimal azimuth within a time range by minimizing
one component.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The object is initialized with the <code class="docutils literal notranslate"><span class="pre">rfV1</span></code> field only, and
other attributes are added to the object as the analysis proceeds.
A second <code class="docutils literal notranslate"><span class="pre">rfV2</span></code> can be included, which is typically a copy of <code class="docutils literal notranslate"><span class="pre">rfV1</span></code>
filtered at different corner frequencies and is used to stack along the
Pps and Pss moveout curves.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radialRF</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream object containing the radial-component receiver function
seismograms</p></li>
<li><p><strong>transvRF</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream object containing the transverse-component receiver function
seismograms</p></li>
<li><p><strong>azim</strong> (<em>float</em>) – Direction (azimuth) along which the B1 component of the stream
is minimized (between <code class="docutils literal notranslate"><span class="pre">xmin</span></code> and <code class="docutils literal notranslate"><span class="pre">xmax</span></code>)</p></li>
<li><p><strong>xmin</strong> (<em>float</em>) – Minimum x axis value over which to calculate <code class="docutils literal notranslate"><span class="pre">azim</span></code></p></li>
<li><p><strong>xmax</strong> (<em>float</em>) – Maximum x axis value over which to calculate <code class="docutils literal notranslate"><span class="pre">azim</span></code></p></li>
<li><p><strong>hstream</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream containing the 5 harmonics, oriented in direction <code class="docutils literal notranslate"><span class="pre">azim</span></code></p></li>
<li><p><strong>radial_forward</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>, optional) – Stream containing the radial receiver functions</p></li>
<li><p><strong>transv_forward</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>, optional) – Stream containing the transverse receiver functions</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rfpy.harmonics.Harmonics.dcomp_find_azim">
<span class="sig-name descname"><span class="pre">dcomp_find_azim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.harmonics.Harmonics.dcomp_find_azim" title="Link to this definition"></a></dt>
<dd><p>Method to decompose radial and transverse receiver function
streams into back-azimuth harmonics and determine the main
orientation <code class="docutils literal notranslate"><span class="pre">azim</span></code>, obtained by minimizing the B1 component
between <code class="docutils literal notranslate"><span class="pre">xmin</span></code> and <code class="docutils literal notranslate"><span class="pre">xmax</span></code> (i.e., time or depth).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xmin</strong> (<em>float</em>) – Minimum x axis value over which to calculate <code class="docutils literal notranslate"><span class="pre">azim</span></code></p></li>
<li><p><strong>xmax</strong> (<em>float</em>) – Maximum x axis value over which to calculate <code class="docutils literal notranslate"><span class="pre">azim</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rfpy.harmonics.Harmonics.hstream">
<span class="sig-name descname"><span class="pre">hstream</span></span><a class="headerlink" href="#rfpy.harmonics.Harmonics.hstream" title="Link to this definition"></a></dt>
<dd><p>Stream containing the 5 harmonics, oriented in direction <code class="docutils literal notranslate"><span class="pre">azim</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rfpy.harmonics.Harmonics.azim">
<span class="sig-name descname"><span class="pre">azim</span></span><a class="headerlink" href="#rfpy.harmonics.Harmonics.azim" title="Link to this definition"></a></dt>
<dd><p>Direction (azimuth) along which the B1 component of the stream
is minimized (between <code class="docutils literal notranslate"><span class="pre">xmin</span></code> and <code class="docutils literal notranslate"><span class="pre">xmax</span></code>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rfpy.harmonics.Harmonics.var">
<span class="sig-name descname"><span class="pre">var</span></span><a class="headerlink" href="#rfpy.harmonics.Harmonics.var" title="Link to this definition"></a></dt>
<dd><p>Variance of the 5 harmonics between <code class="docutils literal notranslate"><span class="pre">xmin</span></code> and <code class="docutils literal notranslate"><span class="pre">xmax</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.harmonics.Harmonics.dcomp_fix_azim">
<span class="sig-name descname"><span class="pre">dcomp_fix_azim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">azim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.harmonics.Harmonics.dcomp_fix_azim" title="Link to this definition"></a></dt>
<dd><p>Method to decompose radial and transverse receiver function
streams into back-azimuth harmonics along direction <code class="docutils literal notranslate"><span class="pre">azim</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>azim</strong> (<em>float</em>) – Direction (azimuth) along which the B1 component of the stream
is minimized (between <code class="docutils literal notranslate"><span class="pre">xmin</span></code> and <code class="docutils literal notranslate"><span class="pre">xmax</span></code>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">hstream</span></span><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Stream containing the 5 harmonics, oriented in direction <code class="docutils literal notranslate"><span class="pre">azim</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.harmonics.Harmonics.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">baz_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.harmonics.Harmonics.forward" title="Link to this definition"></a></dt>
<dd><p>Method to forward calculate radial and transverse component
receiver functions given the 5 pre-determined harmonics and
a list of back-azimuth values. The receiver function signal
parameters (length, sampling rate, etc.) will be identical
to those in the stream of harmonic components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>baz_list</strong> (<em>list</em>) – List of back-azimuth directions over which to calculate
the receiver functions. If no list is specified, the method
will use the same back-azimuths as those in the original
receiver function streams</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rfpy.harmonics.Harmonics.radial_forward">
<span class="sig-name descname"><span class="pre">radial_forward</span></span><a class="headerlink" href="#rfpy.harmonics.Harmonics.radial_forward" title="Link to this definition"></a></dt>
<dd><p>Stream containing the radial receiver functions</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rfpy.harmonics.Harmonics.transv_forward">
<span class="sig-name descname"><span class="pre">transv_forward</span></span><a class="headerlink" href="#rfpy.harmonics.Harmonics.transv_forward" title="Link to this definition"></a></dt>
<dd><p>Stream containing the transverse receiver functions</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.harmonics.Harmonics.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">form</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.harmonics.Harmonics.plot" title="Link to this definition"></a></dt>
<dd><p>Method to plot the 5 harmonic components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ymax</strong> (<em>float</em>) – Maximum y axis value (time or depth) over which to
plot the harmonic components</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – Scaling factor for the amplitudes (typically &gt; 1)</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – Whether or not to save the plot</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title of plot, to be used in the Figure and the
file name (if <code class="docutils literal notranslate"><span class="pre">save==True</span></code>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.harmonics.Harmonics.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.harmonics.Harmonics.save" title="Link to this definition"></a></dt>
<dd><p>Saves harmonics object to file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – File name for Harmonics object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="ccpimage">
<h2>CCPimage<a class="headerlink" href="#ccpimage" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="rfpy.ccp.CCPimage">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rfpy.ccp.</span></span><span class="sig-name descname"><span class="pre">CCPimage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1.0,</span> <span class="pre">3.0,</span> <span class="pre">-3.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">4.,</span> <span class="pre">8.,</span> <span class="pre">14.,</span> <span class="pre">30.,</span> <span class="pre">35.,</span> <span class="pre">45.,</span> <span class="pre">110.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([4.,</span> <span class="pre">5.9,</span> <span class="pre">6.2,</span> <span class="pre">6.3,</span> <span class="pre">6.8,</span> <span class="pre">7.2,</span> <span class="pre">8.,</span> <span class="pre">8.1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vpvs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.73</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.ccp.CCPimage" title="Link to this definition"></a></dt>
<dd><p>A CCPimage object contains attributes and methods to produce
Common Conversion Point (CCP) stacks for each of the main
three main phases (Ps, Pps and Pss) using radial-component
receiver functions. The object is used to project the stacks along
a linear profile, specified by start and end geographical coordinate
locations, which are subsequently averaged to produce a final
CCP image. The averaging can be done using a linear weighted sum,
or a phase-weighted sum. Methods should be used in the appropriate
sequence (see <code class="docutils literal notranslate"><span class="pre">rfpy_ccp.py</span></code> for details).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, the object initializes with un-defined coordinate locations for
the profile. If not specified during initialization, make sure
they are specified later, before the other methods are used, e.g.
<code class="docutils literal notranslate"><span class="pre">ccpimage.xs_lat1</span> <span class="pre">=</span> <span class="pre">10.;</span> <span class="pre">ccpimage.xs_lon1</span> <span class="pre">=</span> <span class="pre">110.</span></code>, etc. Note also that the
default 1D velocity model may not be applicable to your region of
interest and a different model can be implemented during initialization
or later during processing.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coord_start</strong> (<em>list</em>) – List of two floats corresponding to the (latitude, longitude)
pair for the start point of the profile</p></li>
<li><p><strong>coord_end</strong> (<em>list</em>) – List of two floats corresponding to the (latitude, longitude)
pair for the end point of the profile</p></li>
<li><p><strong>weights</strong> (<em>list</em>) – List of three floats with corresponding weights for the Ps, Pps
and Pss phases used during linear, weighted averaging</p></li>
<li><p><strong>dep</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of depth values defining the 1D background seismic velocity model.
Note that the maximum depth defined here sets the maximum depth
in each of the CCP stacks and the final CCP image.</p></li>
<li><p><strong>vp</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of Vp values defining the 1D background seismic velocity model</p></li>
<li><p><strong>vpvs</strong> (<em>float</em>) – Constant Vp/Vs ratio for the 1D model.</p></li>
<li><p><strong>radialRF</strong> (<em>list</em>) – List of <code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code> objects containing the radial
receiver functions along the line. Each item in the list contains the
streams for one single station.</p></li>
<li><p><strong>vs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of Vp values defining the 1D background seismic velocity model</p></li>
<li><p><strong>xs_lat1</strong> (<em>float</em>) – Latitude of start point defining the linear profile.</p></li>
<li><p><strong>xs_lon1</strong> (<em>float</em>) – Longitude of start point defining the linear profile.</p></li>
<li><p><strong>xs_lat2</strong> (<em>float</em>) – Latitude of end point defining the linear profile.</p></li>
<li><p><strong>xs_lon2</strong> (<em>float</em>) – Longitude of end point defining the linear profile.</p></li>
<li><p><strong>is_ready_for_prep</strong> (<em>boolean</em>) – Whether or not the object is ready for the method <code class="docutils literal notranslate"><span class="pre">prep_data</span></code></p></li>
<li><p><strong>is_ready_for_prestack</strong> (<em>boolean</em>) – Whether or not the object is ready for the method <code class="docutils literal notranslate"><span class="pre">prestack</span></code></p></li>
<li><p><strong>is_ready_for_ccp</strong> (<em>boolean</em>) – Whether or not the object is ready for the method <code class="docutils literal notranslate"><span class="pre">ccp</span></code></p></li>
<li><p><strong>is_ready_for_gccp</strong> (<em>boolean</em>) – Whether or not the object is ready for the method <code class="docutils literal notranslate"><span class="pre">gccp</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rfpy.ccp.CCPimage.add_rfstream">
<span class="sig-name descname"><span class="pre">add_rfstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rfstream</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.ccp.CCPimage.add_rfstream" title="Link to this definition"></a></dt>
<dd><p>Method to add a <code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code> object to the list
<code class="docutils literal notranslate"><span class="pre">radialRF</span></code>. With at least one stream in <code class="docutils literal notranslate"><span class="pre">radialRF</span></code>, the object
is ready for the <code class="docutils literal notranslate"><span class="pre">prep_data</span></code> method, and the corresponding flag is
updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rfstream</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream object containing radial receiver functions for one station</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.ccp.CCPimage.prep_data">
<span class="sig-name descname"><span class="pre">prep_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f2ps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f2pps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f2pss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbaz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">37</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nslow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">41</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.ccp.CCPimage.prep_data" title="Link to this definition"></a></dt>
<dd><p>Method to pre-process the data and calculate the CCP points for each
of the receiver functions. Pre-processing includes the binning to
back-azimuth and slowness bins to reduce processing time and generate
cleaner stacks, as well as filtering to emphasize the energy of the
various phases as a function of depth. As a general rule, the high
frequency corner of the 2 reverberated phases (Pps and Pss) should be
approximately half of the high frequency corner of the direct
(Ps) phase. At the end of this step, the object is updated with
the amplitude at the lat, lon and depth values corresponding to the
raypath for each receiver function. The object is now ready for the
method <code class="docutils literal notranslate"><span class="pre">prestack</span></code>, with the corresponding flag updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f1</strong> (<em>float</em>) – Low-frequency corner of the bandpass filter used for all phases (Hz)</p></li>
<li><p><strong>f2ps</strong> (<em>float</em>) – High-frequency corner of the bandpass filter used for the Ps phase (Hz)</p></li>
<li><p><strong>f2pps</strong> (<em>float</em>) – High-frequency corner of the bandpass filter used for the Pps phase (Hz)</p></li>
<li><p><strong>f2pss</strong> (<em>float</em>) – High-frequency corner of the bandpass filter used for the Pss phase (Hz)</p></li>
<li><p><strong>nbaz</strong> (<em>int</em>) – Number of increments in the back-azimuth bins</p></li>
<li><p><strong>nslow</strong> (<em>int</em>) – Number of increments in the slowness bins</p></li>
<li><p><strong>object</strong> (<em>The following attributes are added to the</em>)</p></li>
<li><p><strong>amp_ps_depth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D array of amplitudes as a function of depth for the Ps phase</p></li>
<li><p><strong>amp_pps_depth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D array of amplitudes as a function of depth for the Pps phase</p></li>
<li><p><strong>amp_pss_depth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D array of amplitudes as a function of depth for the Pss phase</p></li>
<li><p><strong>lon_depth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D array of longitude as a function of depth (i.e., piercing points)</p></li>
<li><p><strong>lat_depth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D array of latitude as a function of depth (i.e., piercing points)</p></li>
<li><p><strong>is_ready_for_presstack</strong> (<em>boolean</em>) – Flag specifying that the object is ready for the presstack() method</p></li>
<li><p><strong>n_traces</strong> (<em>float</em>) – Total number of traces used in creating the CCP image.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.ccp.CCPimage.prestack">
<span class="sig-name descname"><span class="pre">prestack</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.ccp.CCPimage.prestack" title="Link to this definition"></a></dt>
<dd><p>Method to project the raypaths onto the 2D profile for each of the three
phases. The final grid is defined here, using the parameter <code class="docutils literal notranslate"><span class="pre">dx</span></code> in km.
The horizontal extent is pre-determined from the start and end points of
the profile. At the end of this step, the object contains the set of
amplitudes at each of the 2D grid points, for each of the three phases.
The object is now ready for the methods <code class="docutils literal notranslate"><span class="pre">ccp</span></code> and/or <code class="docutils literal notranslate"><span class="pre">gccp</span></code>, with
the corresponding flag updated.</p>
<p>The following attributes are added to the object:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs_amps_ps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 3D array of amplitudes (1D array of amplitudes at each grid cell)
for the Ps phase</p></li>
<li><p><strong>xs_amps_pps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 3D array of amplitudes (1D array of amplitudes at each grid cell)
for the Pps phase</p></li>
<li><p><strong>xs_amps_pss</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 3D array of amplitudes (1D array of amplitudes at each grid cell)
for the Pss phase</p></li>
<li><p><strong>is_ready_for_ccp</strong> (<em>boolean</em>) – Flag specifying that the object is ready for the ccp() method</p></li>
<li><p><strong>is_ready_for_gccp</strong> (<em>boolean</em>) – Flag specifying that the object is ready for the gccp() method</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.ccp.CCPimage.ccp">
<span class="sig-name descname"><span class="pre">ccp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.ccp.CCPimage.ccp" title="Link to this definition"></a></dt>
<dd><p>Method to average the amplitudes at each grid point to produce 2D images
for each of the three phases. At the end of this step, the object
contains the three 2D arrays that can be further averaged into a single
final image.</p>
<p>The following attributes are added to the object:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs_ps_avg</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D array of stacked amplitudes for the Ps phase</p></li>
<li><p><strong>xs_pps_avg</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D array of stacked amplitudes for the Pps phase</p></li>
<li><p><strong>xs_pss_avg</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D array of stacked amplitudes for the Pss phase</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.ccp.CCPimage.gccp">
<span class="sig-name descname"><span class="pre">gccp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.ccp.CCPimage.gccp" title="Link to this definition"></a></dt>
<dd><p>Method to average the amplitudes at each grid point to produce 2D images
for each of the three phases. In this method, the grid points are further
smoothed in the horizontal direction using a Gaussian function to simulate
P-wave sensitivity kernels. At the end of this step, the object
contains the three 2D smoothed arrays that can be further averaged into a
single final image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wlen</strong> (<em>float</em>) – Wavelength of the P-wave for smoothing (km).</p></li>
<li><p><strong>object</strong> (<em>The following attributes are added to the</em>)</p></li>
<li><p><strong>xs_gauss_ps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D array of stacked and Gaussian-filtered amplitudes for the Ps phase</p></li>
<li><p><strong>xs_gauss_pps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D array of stacked and Gaussian-filtered amplitudes for the Pps phase</p></li>
<li><p><strong>xs_gauss_pss</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D array of stacked and Gaussian-filtered amplitudes for the Pss phase</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.ccp.CCPimage.linear_stack">
<span class="sig-name descname"><span class="pre">linear_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">typ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ccp'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.ccp.CCPimage.linear_stack" title="Link to this definition"></a></dt>
<dd><p>Method to average the three 2D images into a final, weighted CCP image
using the weights defined in the attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>typ</strong> (<em>str</em>) – Type of phase stacks to use (either <cite>ccp</cite> or <cite>gccp</cite>)</p></li>
<li><p><strong>object</strong> (<em>The following attributes are added to the</em>)</p></li>
<li><p><strong>tot_trace</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D array of amplitudes for the linearly combined Ps, Pps and Pss phases</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.ccp.CCPimage.phase_weighted_stack">
<span class="sig-name descname"><span class="pre">phase_weighted_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">typ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gccp'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.ccp.CCPimage.phase_weighted_stack" title="Link to this definition"></a></dt>
<dd><p>Method to average the three 2D smoothed images into a final,
phase-weighted CCP image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>typ</strong> (<em>str</em>) – Type of phase stacks to use (either <cite>ccp</cite> or <cite>gccp</cite>)</p></li>
<li><p><strong>object</strong> (<em>The following attributes are added to the</em>)</p></li>
<li><p><strong>tot_trace</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D array of amplitudes for the phase-weighted, combined
Ps, Pps and Pss phases</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.ccp.CCPimage.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.ccp.CCPimage.save" title="Link to this definition"></a></dt>
<dd><p>Method to save the <cite>ccpimage</cite> object to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>title</strong> (<em>str</em>) – File name for the saved object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.ccp.CCPimage.plot_ccp">
<span class="sig-name descname"><span class="pre">plot_ccp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.ccp.CCPimage.plot_ccp" title="Link to this definition"></a></dt>
<dd><p>Method to plot the final CCP stacks along the line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmin</strong> (<em>float</em>) – Maximum negative value for the color scale</p></li>
<li><p><strong>vmax</strong> (<em>float</em>) – Maximum positive value for the color scale</p></li>
<li><p><strong>save</strong> (<em>boolean</em>) – Whether or not to save the figure.</p></li>
<li><p><strong>fmt</strong> (<em>str</em>) – Format of saved figure</p></li>
<li><p><strong>xlen</strong> (<em>float</em>) – Total length of profile</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfpy.ccp.CCPimage.plot_gccp">
<span class="sig-name descname"><span class="pre">plot_gccp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.015</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.015</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.ccp.CCPimage.plot_gccp" title="Link to this definition"></a></dt>
<dd><p>Method to plot the final GCCP stacks along the line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmin</strong> (<em>float</em>) – Maximum negative value for the color scale</p></li>
<li><p><strong>vmax</strong> (<em>float</em>) – Maximum positive value for the color scale</p></li>
<li><p><strong>save</strong> (<em>boolean</em>) – Whether or not to save the figure.</p></li>
<li><p><strong>fmt</strong> (<em>str</em>) – Format of saved figure</p></li>
<li><p><strong>xlen</strong> (<em>float</em>) – Total length of profile</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="modules">
<h1>Modules<a class="headerlink" href="#modules" title="Link to this heading"></a></h1>
<section id="module-rfpy.binning">
<span id="binning"></span><h2>binning<a class="headerlink" href="#module-rfpy.binning" title="Link to this heading"></a></h2>
<p>Functions to bin receiver functions along back-azimuth or slowness
bins, or both, or for all data, regardless of the x axis (time or depth).</p>
<dl class="py function">
<dt class="sig sig-object py" id="rfpy.binning.bin">
<span class="sig-prename descclassname"><span class="pre">rfpy.binning.</span></span><span class="sig-name descname"><span class="pre">bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'baz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">37</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_empty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.binning.bin" title="Link to this definition"></a></dt>
<dd><p>Function to stack receiver functions into (baz or slow) bins
This can be done using a linear stack (i.e., simple
mean), or using phase-weighted stacking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream of equal-length seismograms to be stacked into
a single trace.</p></li>
<li><p><strong>stream2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Optionally stack a second stream in the same operation.</p></li>
<li><p><strong>typ</strong> (<em>str</em>) – Attribute to bin
‘baz’: backazimuth (degree)
‘slow’: Horizontal slowness (s/km)
‘dist’: epicentral distance (degree)</p></li>
<li><p><strong>nbin</strong> (<em>int</em>) – Number of equally sized bins within data range</p></li>
<li><p><strong>pws</strong> (<em>bool</em>) – Whether or not to perform phase-weighted stacking</p></li>
<li><p><strong>include_empty</strong> (<em>bool</em>) – Return empty bins as null traces (default omits them)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>stack</strong> – Stream containing one or two stacked traces,
depending on the number of input streams</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rfpy.binning.bin_baz_slow">
<span class="sig-prename descclassname"><span class="pre">rfpy.binning.</span></span><span class="sig-name descname"><span class="pre">bin_baz_slow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbaz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">37</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nslow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">21</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_empty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.binning.bin_baz_slow" title="Link to this definition"></a></dt>
<dd><p>Function to stack receiver functions into back-azimuth and slowness bins.
This can be done using a linear stack (i.e., simple
mean), or using phase-weighted stacking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream of equal-length seismograms to be stacked into
a single trace.</p></li>
<li><p><strong>stream2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Optionally stack a second stream in the same operation.</p></li>
<li><p><strong>nbaz</strong> (<em>int</em>) – Number of back-azimuth samples in bins</p></li>
<li><p><strong>nslow</strong> (<em>int</em>) – Number of slowness samples in bins</p></li>
<li><p><strong>pws</strong> (<em>bool</em>) – Whether or not to perform phase-weighted stacking</p></li>
<li><p><strong>include_empty</strong> (<em>bool</em>) – Return empty bins as null traces (default omits them)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>stack</strong> – Stream containing one or two stacked traces,
depending on the number of input streams</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rfpy.binning.bin_all">
<span class="sig-prename descclassname"><span class="pre">rfpy.binning.</span></span><span class="sig-name descname"><span class="pre">bin_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.binning.bin_all" title="Link to this definition"></a></dt>
<dd><p>Function to bin all streams into a single trace.
This can be done using a linear stack (i.e., simple
mean), or using phase-weighted stacking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream of equal-length seismograms to be stacked into
a single trace.</p></li>
<li><p><strong>stream2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Optionally stack a second stream in the same operation.</p></li>
<li><p><strong>pws</strong> (<em>bool</em>) – Whether or not to perform phase-weighted stacking</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>stack</strong> – Stream containing one or two stacked traces,
depending on the number of input streams</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-rfpy.plotting">
<span id="plotting"></span><h2>plotting<a class="headerlink" href="#module-rfpy.plotting" title="Link to this heading"></a></h2>
<p>Functions to plot single station P-receiver functions as wiggle plots.</p>
<p>Options to plot by receiver functions # vs time/depth, by back-azimuth vs
time/depth or slowness vs time.</p>
<dl class="py function">
<dt class="sig sig-object py" id="rfpy.plotting.wiggle">
<span class="sig-prename descclassname"><span class="pre">rfpy.plotting.</span></span><span class="sig-name descname"><span class="pre">wiggle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">form</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.plotting.wiggle" title="Link to this definition"></a></dt>
<dd><p>Function to plot receiver function traces by index in stream. By default,
only one stream is required, which produces a Figure with a single panel.
Optionally, if a second stream is present, the Figure will contain two
panels. The stream(s) can be sorted by stats attribute <code class="docutils literal notranslate"><span class="pre">sort</span></code>,
normalized, and the Figure can be saved as .eps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream of receiver function traces</p></li>
<li><p><strong>stream2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream of receiver function traces, for a two-panel Figure</p></li>
<li><p><strong>sort</strong> (<em>str</em>) – Name of attribute in the <code class="docutils literal notranslate"><span class="pre">stats</span></code> attribute of indivudial traces, used
to sort the traces in the Stream(s).</p></li>
<li><p><strong>xmax</strong> (<em>float</em>) – Maximum x-axis value displayed in the Figure.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Whether or not to normalize the traces according to the max amplitude
in <code class="docutils literal notranslate"><span class="pre">stream1</span></code></p></li>
<li><p><strong>save</strong> (<em>bool</em>) – Whether or not to save the Figure</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title of plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rfpy.plotting.wiggle_bins">
<span class="sig-prename descclassname"><span class="pre">rfpy.plotting.</span></span><span class="sig-name descname"><span class="pre">wiggle_bins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tr1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tr2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">btyp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'baz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.0,</span> <span class="pre">30.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtyp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rfpy.plotting.wiggle_bins" title="Link to this definition"></a></dt>
<dd><p>Function to plot receiver function according to either baz or
slowness bins. By default, only one stream is required, which produces a
Figure with a single panel. Optionally, if a second stream is present,
the Figure will contain two panels. If the single trace arguments are
present, they will be plotted at the top.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream of receiver function traces</p></li>
<li><p><strong>stream2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Stream of receiver function traces, for a two-panel Figure</p></li>
<li><p><strong>tr1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Trace</span></code>) – Trace to plot at the top of <code class="docutils literal notranslate"><span class="pre">stream1</span></code></p></li>
<li><p><strong>tr2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Trace</span></code>) – Trace to plot at the top of <code class="docutils literal notranslate"><span class="pre">stream2</span></code></p></li>
<li><p><strong>btyp</strong> (<em>str</em>) – Type of plot to produce (either ‘baz’, ‘slow’, or ‘dist’)</p></li>
<li><p><strong>trange</strong> (<em>list</em><em> of </em><em>two floats</em>) – Range of x-axis values displayed in the Figure.</p></li>
<li><p><strong>xtyp</strong> (<em>str</em>) – Type of x-axis label (either ‘time’ or ‘depth’)</p></li>
<li><p><strong>norm</strong> (<em>float</em>) – Normalization value applied to all traces. If not specified,
default amplitude ranges will be set.</p></li>
<li><p><strong>save</strong> (<em>str</em>) – Filename of figure to be saved, including extension.</p></li>
<li><p><strong>folder</strong> (<em>str</em>) – Folder name where figure will be saved.</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – Whether or not to show the figure upon execution.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="rfpy.html" class="btn btn-neutral float-left" title="Licence" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="scripts.html" class="btn btn-neutral float-right" title="Scripts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Pascal Audet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>